function AppleSupportNextDateArray(){this.nextDates={},this.reset=function(){this.nextDates={}}}function addAndEditTODO(e){var a="";if(""!=$("#uidTODO").val())var l=globalResourceCalDAVList.getTodoCollectionByUID($("#uidTODO").val().substring(0,$("#uidTODO").val().lastIndexOf("/")+1));else l=globalResourceCalDAVList.getTodoCollectionByUID($("#todo_calendar").val());var n=getAccount(l.accountUID),r=n.href.match(vCalendar.pre.hrefRex),t=r[1]+n.userAuth.userName+"@"+r[2];if(""!=$("#etagTODO").val())a=$("#uidTODO").val();else{if("choose"==$("#todo_calendar").val())return!1;a=$("#todo_calendar").val()+""}todoToVcalendar("EDIT",t,a,$("#etagTODO").val(),"",e)}function interResourceEditTODO(e,a){if(""!=$("#uidTODO").val())var l=globalResourceCalDAVList.getTodoCollectionByUID($("#uidTODO").val().substring(0,$("#uidTODO").val().lastIndexOf("/")+1));else l=globalResourceCalDAVList.getTodoCollectionByUID($("#todo_calendar").val());var n=getAccount(l.accountUID),r=n.href.match(vCalendar.pre.hrefRex),t=r[1]+n.userAuth.userName+"@"+r[2];"MOVE_IN"!=e&&$("#etagTODO").val("");var s=$("#uidTODO").val().substring($("#uidTODO").val().lastIndexOf("/")+1,$("#uidTODO").val().length);todoToVcalendar(e,t,$("#todo_calendar").val()+s,"",a,!1)}function saveTodo(e){$("#todo_details_template").scrollTop(0);var a=$("#uidTODO").val().substring(0,$("#uidTODO").val().lastIndexOf("/")),l=$("#todo_calendar").val().substring(0,$("#todo_calendar").val().length-1);if($("#todo_details_template").find("img[data-type=invalidVerySmall],img[data-type=invalidSmall]").filter(function(){return"none"!=this.style.display}).length>0)return show_editor_loader_messageCalendar("vtodo","message_error",localization[globalInterfaceLanguage].txtErorInputTodo),!1;if("choose"!=$("#todo_calendar").val()){if(""==$("#nameTODO").val()&&$("#name").val(localization[globalInterfaceLanguage].pholderNewTODO),"start"==$("#todo_type").val()||"due"==$("#todo_type").val()||"both"==$("#todo_type").val()){if(""!=$("#date_toTODO").val()&&""!=$("#date_fromTODO").val()){var n=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_fromTODO").val()),r=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_toTODO").val()),t=$.fullCalendar.formatDate(n,"yyyy-MM-dd"),s=$.fullCalendar.formatDate(r,"yyyy-MM-dd"),c="00:00",p="00:00";if(""!=$("#time_fromTODO").val()&&""!=$("#time_toTODO").val()&&(c=new Date(Date.parse("01/02/1990, "+$("#time_fromTODO").val())),c=$.fullCalendar.formatDate(c,"HH:mm"),p=new Date(Date.parse("01/02/1990, "+$("#time_toTODO").val())),p=$.fullCalendar.formatDate(p,"HH:mm")),"both"==$("#todo_type").val()&&$.fullCalendar.parseDate(t+"T"+c+"Z")>$.fullCalendar.parseDate(s+"T"+p+"Z"))return show_editor_loader_messageCalendar("vtodo","message_error",localization[globalInterfaceLanguage].txtErrorDatesTodo),!1}if(""!=$("#date_toTODO").val()||""!=$("#date_fromTODO").val()){if(l==a||""==$("#etagTODO").val())addAndEditTODO(e);else if(""!=$("#etagTODO").val()){interResourceEditTODO("MOVE_OTHER",$("#uidTODO").val())}}else show_editor_loader_messageCalendar("vtodo","message_error",localization[globalInterfaceLanguage].txtDateTimeErrorTodo)}else if(l==a||""==$("#etagTODO").val())addAndEditTODO(e);else if(""!=$("#etagTODO").val()){interResourceEditTODO("MOVE_OTHER",$("#uidTODO").val())}}else show_editor_loader_messageCalendar("vtodo","message_error",localization[globalInterfaceLanguage].txtNotChooseTodo)}function deleteTodo(){var e=$("#uidTODO").val();""!=e&&deleteVcalendarFromCollection(e,"vtodo")}function getRepeatTodoObject(e){var a=!1,l=new Array,n="",r=!1,t="",s=e.vCalendarText,c="",p=jQuery.grep(globalEventList.displayTodosArray[e.rid],function(a){if(a.id==e.uidTodo&&(globalSettings.appleremindersmode.value||a.repeatCount<2||!a.repeatCount))return!0});globalSettings.appleremindersmode.value&&1==p.length&&(""==e.recurrenceId&&""==e.futureStart||(a=!0));for(var d=0;d<p.length;d++)if(-1==l.indexOf(p[d].timeZone)){if(!a&&e.deleteMode&&e.vcalendarHash==hex_sha256(p[d].vcalendar))continue;var o=buildTimezoneComponent(p[d].timeZone);""!=o&&e.vcalendarHash!=hex_sha256(p[d].vcalendar)?(l[l.length]=p[d].timeZone,(n+=o).lastIndexOf("\r\n")!=n.length-2&&(n+="\r\n"),r=!0):""!=o&&e.vcalendarHash==hex_sha256(p[d].vcalendar)&&(t+=o)}r&&(s.lastIndexOf("\r\n")!=s.length-2&&(s+="\r\n"),s+=n);var i=s,_="",m="",v=new Array;if(p.length>0){var T=e.uidTodo.substring(0,e.uidTodo.lastIndexOf("/")+1);for(T&&null!=globalEventList.todos[T][e.uidTodo].uid&&(m=globalEventList.todos[T][e.uidTodo].vcalendar);null!=m.match(vCalendar.pre.vtodo);){if("\r\n"==m.substring(m.indexOf("BEGIN:VTODO")-2,m.indexOf("BEGIN:VTODO"))){var u=m.substring(m.indexOf("BEGIN:VTODO")-2,m.indexOf("END:VTODO")+"END:VTODO".length);m=m.replace(u,"")}else{u=m.substring(m.indexOf("BEGIN:VTODO"),m.indexOf("END:VTODO")+"END:VTODO".length);m=m.replace(u,""),u+="\r\n"}v[v.length]=u}}for(var g=s,C=!1,f=0;f<p.length;f++)if(v.splice(v.indexOf(p[f].vcalendar),1),""==e.futureStart&&e.vcalendarHash!=hex_sha256(p[f].vcalendar)||p[f].rec_id!=e.recurrenceId){var O=p[f].vcalendar.match(vCalendar.pre.contentline_UID);if(null!=O&&(O=O[0].match(vCalendar.pre.contentline_parse)[4]),e.deleteMode&&e.vcalendarHash==hex_sha256(p[f].vcalendar)||e.deleteMode&&!p[f].rec_id&&e.vcalendarUID==O||a){x=p[f].vcalendar.match(vCalendar.pre.contentline_RRULE2);x;var D=p[f].start,E=vCalendar.tplC.VTcontentline_EXDATE;if(E=(E=E.replace("##:::##group_wd##:::##","")).replace("##:::##params_wsc##:::##",""),D=e.recurrenceId.parseComnpactISO8601(),globalSettings.timezonesupport.value&&(c=e.timezoneTODO),"local"!=c){var V=-1*(S=getOffsetByTZ(c,D)).getSecondsFromOffset();D=new Date(D.setSeconds(V))}else D=new Date(D.setSeconds(getLocalOffset(D)));D=$.fullCalendar.formatDate(D,"yyyyMMdd'T'HHmmss'Z'"),E=(E=(E=E.replace("##:::##AllDay##:::##",vcalendarEscapeValue(""))).replace("##:::##TZID##:::##","")).replace("##:::##value##:::##",vcalendarEscapeValue(D)),p[f].finalString.length,p[f].vcalendar=p[f].vcalendar.replace(x,x+p[f].finalString.substring(2,p[f].finalString.length)),a||(p[f].vcalendar=p[f].vcalendar.replace(x,x+E))}else{null!=(A=(p[f].vcalendar+"\r\n").match(vCalendar.pre.endVTODO))&&p[f].finalString.length>2&&(p[f].vcalendar=p[f].vcalendar.replace(A[0].substring(0,A[0].length-2),p[f].finalString+A[0].substring(2,A[0].length)))}var M=p[f].vcalendar;if(a&&void 0!==globalAppleSupport.nextDates[p[f].id]){var h="",A="";null!=M.match(vCalendar.pre.contentline_DTSTART)&&null!=M.match(vCalendar.pre.contentline_DUE)&&(h=M.match(vCalendar.pre.contentline_DTSTART)[0].match(vCalendar.pre.contentline_parse)[4],A=M.match(vCalendar.pre.contentline_DUE)[0].match(vCalendar.pre.contentline_parse)[4]);var R=!1;globalSettings.timezonesupport.value&&(c=e.timezoneTODO),"UTC"==c&&(R=!0);var b=new Date(globalAppleSupport.nextDates[p[f].id].getTime()),S=getOffsetByTZ(c,b);V="";V="undefined"!=typeof globalSessionTimeZone&&null!=globalSessionTimeZone&&""!=globalSessionTimeZone?getOffsetByTZ(globalSessionTimeZone,b).getSecondsFromOffset():60*b.getTimezoneOffset()*-1,V=S.getSecondsFromOffset()-V,b.setSeconds(V);var I=$.fullCalendar.formatDate(b,"yyyyMMdd'T'HHmmss");p[f].vcalendar=p[f].vcalendar.replace(A,vcalendarEscapeValue(I+(R?"Z":""))),p[f].vcalendar=p[f].vcalendar.replace(h,vcalendarEscapeValue(I+(R?"Z":""))),""!=p[f].after&&(p[f].vcalendar=changeRuleForFuture(p[f],p[f].after)),M=p[f].vcalendar}0==M.indexOf("\r\n")&&s.lastIndexOf("\r\n")==s.length-2?s+=M.substring(2,M.length):0==M.indexOf("\r\n")&&s.lastIndexOf("\r\n")!=s.length-2||0!=M.indexOf("\r\n")&&s.lastIndexOf("\r\n")==s.length-2?s+=M:s+="\r\n"+M}else if(""!=e.futureStart.split(";")[0]&&e.futureStart.split(";")[1]!=p[f].start&&e.futureStart.split(";")[1]!=p[f].end){var x=p[f].vcalendar.match(vCalendar.pre.contentline_RRULE2);p[f].finalString.length,p[f].vcalendar=p[f].vcalendar.replace(x,x+p[f].finalString.substring(2,p[f].finalString.length)),e.futureStart.split(";")[0]>1&&e.vcalendarHash==hex_sha256(p[f].vcalendar)&&(p[f].vcalendar=changeRuleForFuture(p[f],e.futureStart.split(";")[0])),0==p[f].vcalendar.indexOf("\r\n")&&s.lastIndexOf("\r\n")==s.length-2?s+=p[f].vcalendar.substring(2,p[f].vcalendar.length):0==p[f].vcalendar.indexOf("\r\n")&&s.lastIndexOf("\r\n")!=s.length-2||0!=p[f].vcalendar.indexOf("\r\n")&&s.lastIndexOf("\r\n")==s.length-2?s+=p[f].vcalendar:s+="\r\n"+p[f].vcalendar,C=!0}else if(!e.deleteMode||""==e.futureStart.split(";")[0]||e.futureStart.split(";")[1]!=p[f].start&&e.futureStart.split(";")[1]!=p[f].end)_=p[f];else{x=p[f].vcalendar.match(vCalendar.pre.contentline_RRULE2);p[f].finalString.length,p[f].vcalendar=p[f].vcalendar.replace(x,x+p[f].finalString.substring(2,p[f].finalString.length)),e.vcalendarHash==hex_sha256(p[f].vcalendar)&&(p[f].vcalendar=changeRuleForFuture(p[f],2)),0==p[f].vcalendar.indexOf("\r\n")&&s.lastIndexOf("\r\n")==s.length-2?s+=p[f].vcalendar.substring(2,p[f].vcalendar.length):0==p[f].vcalendar.indexOf("\r\n")&&s.lastIndexOf("\r\n")!=s.length-2||0!=p[f].vcalendar.indexOf("\r\n")&&s.lastIndexOf("\r\n")==s.length-2?s+=p[f].vcalendar:s+="\r\n"+p[f].vcalendar}if(s=s.replace(_.vcalendar,""),!a)for(var w=0;w<v.length;w++)0==v[w].indexOf("\r\n")&&s.lastIndexOf("\r\n")==s.length-2?s+=v[w].substring(2,v[w].length):0==v[w].indexOf("\r\n")&&s.lastIndexOf("\r\n")!=s.length-2||0!=v[w].indexOf("\r\n")&&s.lastIndexOf("\r\n")==s.length-2?s+=v[w]:s+="\r\n"+v[w];return{tzArray:l,tzString:n,isTimeZone:r,origTimezone:t,vCalendarText:s,realTodo:_,sel_option:c,futureMode:C,appleTodoMode:a,newFirst:i,beginVcalendar:g}}function todoToVcalendar(e,a,l,n,r,t){var s="",c=0;if(""!=r)var p=r.substring(0,r.lastIndexOf("/")+1);else p=l.substring(0,l.lastIndexOf("/")+1);null!=vCalendar.tplM.VTbegin.form&&null!=(process_elem=vCalendar.tplM.VTbegin.form[0])?s+=vCalendar.tplM.VTbegin.form[0]:(process_elem=vCalendar.tplC.VTbegin,process_elem=process_elem.replace("##:::##group_wd##:::##",""),s+=process_elem),null!=vCalendar.tplM.VTcontentline_VERSION.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_VERSION.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_VERSION,process_elem=process_elem.replace("##:::##group_wd##:::##","")),process_elem=process_elem.replace("##:::##version##:::##","2.0"),s+=process_elem,null!=vCalendar.tplM.VTcontentline_CALSCALE.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_CALSCALE.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_CALSCALE,process_elem=process_elem.replace("##:::##group_wd##:::##","")),process_elem=process_elem.replace("##:::##calscale##:::##","GREGORIAN"),s+=process_elem;var d=getRepeatTodoObject({rid:p,uidTodo:$("#uidTODO").val(),vcalendarHash:$("#vcalendarHashTODO").val(),vcalendarUID:$("#vcalendarUIDTODO").val(),recurrenceId:$("#recurrenceIDTODO").val(),timezoneTODO:$("#timezoneTODO").val(),futureStart:$("#futureStartTODO").val(),deleteMode:t,vCalendarText:s});s=d.vCalendarText;var o=d.tzArray,i=(d.tzString,d.isTimeZone),_=d.origTimezone,m=d.appleTodoMode,v=d.realTodo,T=d.newFirst,u=d.sel_option,g="";if(t||d.futureMode){if(s.lastIndexOf("\r\n")!=s.length-2&&(s+="\r\n"),!i&&(m||d.futureMode&&""!=_)&&(s+=_).lastIndexOf("\r\n")!=s.length-2&&(s+="\r\n"),null!=vCalendar.tplM.VTcontentline_PRODID.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_PRODID.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_PRODID,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##value##:::##","-//Inf-IT//"+globalAppName+" "+globalVersion+"//EN"),s+=process_elem,void 0!==vCalendar.tplM.VTunprocessed.form&&""!=vCalendar.tplM.VTunprocessed.form&&null!=vCalendar.tplM.VTunprocessed.form&&(s+=vCalendar.tplM.VTunprocessed.form.replace(RegExp("^\r\n"),"")),vCalendar.tplM.VTunprocessed.form=new Array,null!=vCalendar.tplM.VTend.form&&null!=(process_elem=vCalendar.tplM.VTend.form[0])?s+=vCalendar.tplM.VTend.form[0]:(process_elem=vCalendar.tplC.VTend,process_elem=process_elem.replace("##:::##group_wd##:::##",""),s+=process_elem),t){var C=(Ye=checkAndFixMultipleUID(s,!1))[0];return Ye.splice(0,1),putVcalendarToCollection(a,l,n,C,r,"vtodo",!1,t,Ye)}d.futureMode&&(g=s,s=d.beginVcalendar)}var f="";"undefined"!=typeof globalSessionTimeZone&&globalSessionTimeZone&&(u=globalSessionTimeZone);var O,D,E=!1,V=s;m&&(s=""),"none"!=$("#todo_type").val()&&(globalSettings.timezonesupport.value&&(u=$("#timezoneTODO").val()),"UTC"==u?(E=!0,f=""):f="local"==u?"":"custom"==u?";"+vcalendarEscapeValue("TZID="+v.timeZone):";"+vcalendarEscapeValue("TZID="+u),s.lastIndexOf("\r\n")!=s.length-2&&(s+="\r\n"),globalSettings.rewritetimezonecomponent.value||!vCalendar.tplM.VTunprocessedVTIMEZONE.form?-1==o.indexOf(u)&&(s+=buildTimezoneComponent(u)):s+=vCalendar.tplM.VTunprocessedVTIMEZONE.form),V+=s,null!=vCalendar.tplM.VTbeginVTODO.form&&null!=(process_elem=vCalendar.tplM.VTbeginVTODO.form[0])?s+=vCalendar.tplM.VTbeginVTODO.form[0]:(process_elem=vCalendar.tplC.VTbeginVTODO,process_elem=process_elem.replace("##:::##group_wd##:::##",""),s+=process_elem),D=(O=new Date).getUTCFullYear()+(O.getUTCMonth()+1<10?"0":"")+(O.getUTCMonth()+1)+(O.getUTCDate()<10?"0":"")+O.getUTCDate()+"T"+(O.getUTCHours()<10?"0":"")+O.getUTCHours()+(O.getUTCMinutes()<10?"0":"")+O.getUTCMinutes()+(O.getUTCSeconds()<10?"0":"")+O.getUTCSeconds()+"Z";if(""==$("#recurrenceIDTODO").val())var M="orig";else M=$("#recurrenceIDTODO").val();var h="";for(vev in vCalendar.tplM.VTcontentline_CREATED.form)vev==M&&(h=vCalendar.tplM.VTcontentline_CREATED.form[vev]);""!=h?(process_elem=h,""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2))):(process_elem=vCalendar.tplC.VTcontentline_CREATED,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(D))),s+=process_elem,null!=vCalendar.tplM.VTcontentline_LM.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_LM.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_LM,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(D)),s+=process_elem,null!=vCalendar.tplM.VTcontentline_DTSTAMP.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_DTSTAMP.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_DTSTAMP,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(D)),s+=process_elem,m||""!=$("#futureStartTODO").val()||"MOVE_IN"==e||"MOVE_OTHER"==e||null==vCalendar.tplM.VTcontentline_UID.form||null==(process_elem=vCalendar.tplM.VTcontentline_UID.form[0])?(process_elem=vCalendar.tplC.VTcontentline_UID,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")):""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2));var A=globalEventList.getNewUID();if(process_elem=process_elem.replace("##:::##uid##:::##",A),s+=process_elem,null!=vCalendar.tplM.VTcontentline_SUMMARY.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_SUMMARY.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_SUMMARY,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),""==$("#nameTODO").val()?process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue("New TODO")):process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue($("#nameTODO").val())),s+=process_elem,"NONE"!=$("#statusTODO").val()&&(null!=vCalendar.tplM.VTcontentline_STATUS.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_STATUS.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_STATUS,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue($("#statusTODO").val())),s+=process_elem),""!=$("#percenteCompleteValue").val()&&(null!=vCalendar.tplM["VTcontentline_PERCENT-COMPLETE"].form&&null!=(process_elem=vCalendar.tplM["VTcontentline_PERCENT-COMPLETE"].form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC["VTcontentline_PERCENT-COMPLETE"],process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue($("#percenteCompleteValue").val())),s+=process_elem),"0"!=$("#priority_TODO").val()&&(null!=vCalendar.tplM.VTcontentline_PRIORITY.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_PRIORITY.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_PRIORITY,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue($("#priority_TODO").val())),s+=process_elem),""!=$("#noteTODO").val()&&(null!=vCalendar.tplM.VTcontentline_NOTE.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_NOTE.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_NOTE,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue($("#noteTODO").val())),s+=process_elem),""!=$("#typeTODO").val()&&(null!=vCalendar.tplM.VTcontentline_CLASS.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_CLASS.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_CLASS,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),void 0!==vCalendar.tplM.VTcontentline_CLASS.form&&null!=vCalendar.tplM.VTcontentline_CLASS.form&&0!=vCalendar.tplM.VTcontentline_CLASS.form.length||(process_elem="")),"none"!=$(".row_typeTODO").css("display")&&(process_elem=vCalendar.tplC.VTcontentline_CLASS,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue($("#typeTODO").val().toUpperCase()))),s+=process_elem),""!=$("#url_TODO").val()&&(null!=vCalendar.tplM.VTcontentline_URL.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_URL.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_URL,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue($("#url_TODO").val())),s+=process_elem),null!=vCalendar.tplM.VTcontentline_LOCATION.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_LOCATION.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_LOCATION,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),""!=$("#location_TODO").val()&&(process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue($("#location_TODO").val())),s+=process_elem),"no-repeat"!=$("#repeat_TODO").val()){var R=$("#repeat_interval_detail_TODO").val(),b="",S=!1,I="",x="",w="";R=1==R||""==R?"":";INTERVAL="+$("#repeat_interval_detail_TODO").val();var L=$("#repeat_TODO").val();if("TWO_WEEKLY"==L)L="WEEKLY",R=";INTERVAL=2";else if("BUSINESS"==L){if(L="WEEKLY",b=";BYDAY=",globalSettings.weekenddays.value.length>0){for(var y=0;y<7;y++)-1==globalSettings.weekenddays.value.indexOf(y)&&(b+=y+",");b=(b=b.substring(0,b.length-1)).replace(1,"MO").replace(2,"TU").replace(3,"WE").replace(4,"TH").replace(5,"FR").replace(6,"SA").replace(0,"SU")}else b="SA,SU";R=""}else if("WEEKEND"==L){if(L="WEEKLY",b=";BYDAY=",globalSettings.weekenddays.value.length>0){for(y=0;y<globalSettings.weekenddays.value.length;y++)b+=globalSettings.weekenddays.value[y]+",";b=(b=b.substring(0,b.length-1)).replace(1,"MO").replace(2,"TU").replace(3,"WE").replace(4,"TH").replace(5,"FR").replace(6,"SA").replace(0,"SU")}else b="SA,SU";R=""}else if("CUSTOM_WEEKLY"==L){L="WEEKLY";var N=$("#week_custom_TODO .customTable td.selected");if(N.length>0){b=";BYDAY=";for(var U=0;U<N.length;U++)b+=$(N[U]).attr("data-type")+",";b=(b=b.substring(0,b.length-1)).replace(1,"MO").replace(2,"TU").replace(3,"WE").replace(4,"TH").replace(5,"FR").replace(6,"SA").replace(0,"SU"),null!=globalSettings.mozillasupport.value&&globalSettings.mozillasupport.value||(""!=v?""!=v.wkst&&(w=";WKST="+v.wkst.replace(1,"MO").replace(2,"TU").replace(3,"WE").replace(4,"TH").replace(5,"FR").replace(6,"SA").replace(0,"SU")):w=";WKST="+globalSettings.datepickerfirstdayofweek.value.toString().replace(1,"MO").replace(2,"TU").replace(3,"WE").replace(4,"TH").replace(5,"FR").replace(6,"SA").replace(0,"SU"))}}else if("CUSTOM_MONTHLY"==L){L="MONTHLY";var P="";if("custom"!=(Z=$("#repeat_month_custom_select_TODO").val())&&"DAY"!=$("#repeat_month_custom_select2_TODO").val()){switch(""!=Z&&(b=";BYDAY="),Z){case"every":P="";break;case"first":P="1";break;case"second":P="2";break;case"third":P="3";break;case"fourth":P="4";break;case"fifth":P="5";break;case"last":P="-1";break;default:P=""}b+=P+$("#repeat_month_custom_select2_TODO").val()}else if("custom"!=Z&&"DAY"==$("#repeat_month_custom_select2_TODO").val())switch(b="",Z){case"every":I=";BYMONTHDAY=";for(var Y=1;Y<32;Y++)I+=Y+",";I=I.substring(0,I.length-1);break;case"first":I=";BYMONTHDAY=1";break;case"second":I=";BYMONTHDAY=2";break;case"third":I=";BYMONTHDAY=3";break;case"fourth":I=";BYMONTHDAY=4";break;case"fifth":I=";BYMONTHDAY=5";break;case"last":I=";BYMONTHDAY=-1";break;default:P="",I=""}else{if((B=$("#month_custom2_TODO .selected")).length>0){I=";BYMONTHDAY=";for(U=0;U<B.length;U++)I+=$(B[U]).attr("data-type")+",";I=I.substring(0,I.length-1)}}}else if("CUSTOM_YEARLY"==L){L="YEARLY";P="";var Z=$("#repeat_year_custom_select1_TODO").val(),H=$("#year_custom3_TODO .selected");if(H.length>0){x=";BYMONTH=";for(U=0;U<H.length;U++){var k=parseInt($(H[U]).attr("data-type"),10);isNaN(k)||(x+=k+1+",")}x=x.substring(0,x.length-1)}if("custom"!=Z&&"DAY"!=$("#repeat_year_custom_select2_TODO").val()){switch(""!=Z&&(b=";BYDAY="),Z){case"every":P="";break;case"first":P="1";break;case"second":P="2";break;case"third":P="3";break;case"fourth":P="4";break;case"fifth":P="5";break;case"last":P="-1";break;default:P=""}b+=P+$("#repeat_month_custom_select2_TODO").val()}else if("custom"!=Z&&"DAY"==$("#repeat_year_custom_select2_TODO").val())switch(b="",Z){case"every":I=";BYMONTHDAY=";for(Y=1;Y<32;Y++)I+=Y+",";I=I.substring(0,I.length-1);break;case"first":I=";BYMONTHDAY=1";break;case"second":I=";BYMONTHDAY=2";break;case"third":I=";BYMONTHDAY=3";break;case"fourth":I=";BYMONTHDAY=4";break;case"fifth":I=";BYMONTHDAY=5";break;case"last":I=";BYMONTHDAY=-1";break;default:P="",I=""}else{var B;if((B=$("#year_custom1_TODO .selected")).length>0){I=";BYMONTHDAY=";for(U=0;U<B.length;U++)I+=$(B[U]).attr("data-type")+",";I=I.substring(0,I.length-1)}}}else"custom_repeat"==$("#repeat_TODO option:selected").attr("data-type")&&(S=!0);if(null!=vCalendar.tplM.VTcontentline_RRULE.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_RRULE.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_RRULE,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),S)process_elem=process_elem.replace("##:::##value##:::##",$("#repeat_TODO").val());else if("on_date"==$("#repeat_end_details_TODO").val()){var z,G=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#repeat_end_date_TODO").val());if("start"==$("#todo_type").val())var F=new Date(Date.parse("01/02/1990, "+$("#time_fromTODO").val()));else F=new Date(Date.parse("01/02/1990, "+$("#time_toTODO").val()));if(G.setHours(F.getHours()),G.setMinutes(F.getMinutes()),G.setSeconds(F.getSeconds()),globalSettings.timezonesupport.value&&u in timezones)var X=getOffsetByTZ(u,G);if(X){var W=1e3*X.getSecondsFromOffset()*-1;G.setTime(G.getTime()+W)}z=$.fullCalendar.formatDate(G,"yyyyMMdd'T'HHmmss'Z'"),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue("FREQ="+L)+R+";UNTIL="+z+x+I+b+w)}else"after"==$("#repeat_end_details_TODO").val()?process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue("FREQ="+L)+R+";COUNT="+parseInt($("#repeat_end_after_TODO").val())+x+I+b+w):process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue("FREQ="+L)+R+x+I+b+w);if(s+=process_elem,v.repeatStart||v.repeatEnd){if(v.repeatStart)var K=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_fromTODO").val());else K=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_toTODO").val());if(v.repeatStart)var Q=v.repeatStart;else Q=v.repeatEnd;var j=new Date(1970,1,1,0,0,0);j=v.repeatStart?new Date(Date.parse("01/02/1990, "+$("#time_fromTODO").val())):new Date(Date.parse("01/02/1990, "+$("#time_toTODO").val())),K.setHours(j.getHours()),K.setMinutes(j.getMinutes()),K.setSeconds(j.getSeconds());var q=K-Q;for(var J in vCalendar.tplM.VTcontentline_EXDATE.form)if(!isNaN(J)){var ee=("\r\n"+vCalendar.tplM.VTcontentline_EXDATE.form[J]).match(vCalendar.pre.contentline_parse),ae=ee[4].parseComnpactISO8601();if(ae){if(-1==ee[4].indexOf("T")){if(v.repeatStart)new Date(Date.parse("01/02/1990, "+$("#time_fromTODO").val()));else new Date(Date.parse("01/02/1990, "+$("#time_toTODO").val()));var le=$.fullCalendar.formatDate(j,"HHmmss");if(ae=(ee[4]+"T"+le).parseComnpactISO8601(),"local"!=u){W=-1*(X=getOffsetByTZ(u,ae)).getSecondsFromOffset();ae=new Date(ae.setSeconds(W))}}else if(-1!=ee[4].indexOf("T"))if("local"!=u){X=getOffsetByTZ(u,ae);var ne=getOffsetByTZ(v.timeZone,ae);W=-1*(X.getSecondsFromOffset()-ne.getSecondsFromOffset());ae=new Date(ae.setSeconds(W))}else{ne=getOffsetByTZ(v.timeZone,ae);ae=new Date(ae.setSeconds(ne.getSecondsFromOffset()))}var re=new Date(ae.getTime()+q);process_elem=vCalendar.tplC.VTcontentline_EXDATE,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),Te=$.fullCalendar.formatDate(re,"yyyyMMdd'T'HHmmss")+("local"!=u?"Z":""),process_elem=process_elem.replace("##:::##AllDay##:::##",vcalendarEscapeValue("")),process_elem=process_elem.replace("##:::##TZID##:::##",vcalendarEscapeValue("")),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(Te)),s+=process_elem}}}}if($("#recurrenceIDTODO").val()&&!m){null!=vCalendar.tplM.VTcontentline_REC_ID.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_REC_ID.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_REC_ID,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""));var te=$("#recurrenceIDTODO").val();-1==te.indexOf("T")?(process_elem=process_elem.replace("##:::##AllDay##:::##",";"+vcalendarEscapeValue("VALUE=DATE")),process_elem=process_elem.replace("##:::##TZID##:::##",vcalendarEscapeValue("")),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(te))):(process_elem=process_elem.replace("##:::##AllDay##:::##",vcalendarEscapeValue("")),process_elem=process_elem.replace("##:::##TZID##:::##",f),E&&"Z"!=te.charAt(te.length-1)&&(te+="Z"),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(te))),s+=process_elem}K=$("#todoDetailsTable").find("tr[data-id]");var se=0;for(y=0;y<K[K.length-1].attributes.length;y++)if("data-id"==K[K.length-1].attributes[y].nodeName){se=K[K.length-1].attributes[y].value;break}for(var ce=new Array,pe=0;pe<se;pe++)if($(".alertTODO[data-id="+(pe+1)+"]").length>0){var de="";if("none"!=$(".alertTODO[data-id="+(pe+1)+"]").val()){if(null!=vCalendar.tplM.VTbeginVALARM.form&&null!=(process_elem=vCalendar.tplM.VTbeginVALARM.form[0])?de+=vCalendar.tplM.VTbeginVALARM.form[0]:(process_elem=vCalendar.tplC.VTbeginVALARM,process_elem=process_elem.replace("##:::##group_wd##:::##",""),de+=process_elem,vevent=!0),"message"==$(".alertTODO[data-id="+(pe+1)+"]").val()){if("on_date"==$(".alert_message_detailsTODO[data-id="+(pe+1)+"]").val()){null!=vCalendar.tplM.VTcontentline_TRIGGER.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_TRIGGER.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_TRIGGER,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""));var oe=$.datepicker.parseDate(globalSettings.datepickerformat.value,$(".message_date_inputTODO[data-id="+(pe+1)+"]").val()),ie=$.fullCalendar.formatDate(oe,"yyyy-MM-dd"),_e=new Date(Date.parse("01/02/1990, "+$(".message_time_inputTODO[data-id="+(pe+1)+"]").val())),me=$.fullCalendar.formatDate(_e,"HH:mm:ss"),ve=$.fullCalendar.parseDate(ie+"T"+me);if(globalSettings.timezonesupport.value&&(u=$("#timezoneTODO").val()),"none"==$(".timezone_rowTODO").css("display")&&(u="local"),"local"!=u){W=-1*(X=getOffsetByTZ(u,ve)).getSecondsFromOffset();ve=new Date(ve.setSeconds(W))}else{W=getLocalOffset(ve);ve=new Date(ve.setSeconds(W))}var Te=$.fullCalendar.formatDate(ve,"yyyyMMdd'T'HHmmss")+"Z";process_elem=process_elem.replace("##:::##VALUE=DATE-TIME##:::##",";VALUE=DATE-TIME"),process_elem=process_elem.replace("##:::##VALUE=DURATION##:::##",""),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(Te)),de+=process_elem}else{var ue="",ge=$(".before_after_inputTODO[data-id="+(pe+1)+"]").val();"minutes_before"==$(".alert_message_detailsTODO[data-id="+(pe+1)+"]").val()&&(ue="-PT"+ge+"M"),"hours_before"==$(".alert_message_detailsTODO[data-id="+(pe+1)+"]").val()&&(ue="-PT"+ge+"H"),"days_before"==$(".alert_message_detailsTODO[data-id="+(pe+1)+"]").val()&&(ue="-P"+ge+"D"),"weeks_before"==$(".alert_message_detailsTODO[data-id="+(pe+1)+"]").val()&&(ue="-P"+ge+"W"),"seconds_before"==$(".alert_message_detailsTODO[data-id="+(pe+1)+"]").val()&&(ue="-PT"+ge+"S"),"minutes_after"==$(".alert_message_detailsTODO[data-id="+(pe+1)+"]").val()&&(ue="PT"+ge+"M"),"hours_after"==$(".alert_message_detailsTODO[data-id="+(pe+1)+"]").val()&&(ue="PT"+ge+"H"),"days_after"==$(".alert_message_detailsTODO[data-id="+(pe+1)+"]").val()&&(ue="P"+ge+"D"),"weeks_after"==$(".alert_message_detailsTODO[data-id="+(pe+1)+"]").val()&&(ue="P"+ge+"W"),"seconds_after"==$(".alert_message_detailsTODO[data-id="+(pe+1)+"]").val()&&(ue="PT"+ge+"S"),null!=vCalendar.tplM.VTcontentline_TRIGGER.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_TRIGGER.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_TRIGGER,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##VALUE=DATE-TIME##:::##",""),process_elem=process_elem.replace("##:::##VALUE=DURATION##:::##",";VALUE=DURATION"),process_elem=process_elem.replace("##:::##value##:::##",ue),de+=process_elem}null!=vCalendar.tplM.VTcontentline_ACTION.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_ACTION.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_ACTION,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue("DISPLAY")),de+=process_elem,null!=vCalendar.tplM.VTcontentline_DESCRIPTION&&null!=(process_elem=vCalendar.tplM.VTcontentline_DESCRIPTION[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_DESCRIPTION,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue("Reminder")),de+=process_elem}void 0!==vCalendar.tplM.VTunprocessedVALARM.form&&""!=vCalendar.tplM.VTunprocessedVALARM.form&&null!=vCalendar.tplM.VTunprocessedVALARM.form&&null!=vCalendar.tplM.VTunprocessedVALARM.form[pe]&&(tmp=vCalendar.tplM.VTunprocessedVALARM.form[pe].replace(RegExp("^\r\n"),"").replace(RegExp("\r\n$"),""),0==tmp.indexOf("\r\n")&&(tmp=tmp.substring(2,tmp.length)),tmp.lastIndexOf("\r\n")!=tmp.length-2&&(tmp+="\r\n"),de+=tmp),null!=vCalendar.tplM.VTendVALARM.form&&null!=(process_elem=vCalendar.tplM.VTendVALARM.form[0])?de+=vCalendar.tplM.VTendVALARM.form[0]:(process_elem=vCalendar.tplC.VTendVALARM,process_elem=process_elem.replace("##:::##group_wd##:::##",""),de+=process_elem),-1==ce.indexOf(de)&&(ce.push(de),s+=de)}}if("start"==$("#todo_type").val()||"due"==$("#todo_type").val()||"both"==$("#todo_type").val()){if(""==$("#date_fromTODO").val()&&""==$("#date_toTODO").val())return alert("Not enough data!"),!1;if(("start"==$("#todo_type").val()||"both"==$("#todo_type").val()&&!m)&&""!=$("#date_fromTODO").val()){null!=vCalendar.tplM.VTcontentline_E_DTSTART.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_E_DTSTART.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_E_DTSTART,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""));var Ce=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_fromTODO").val()),fe=$.fullCalendar.formatDate(Ce,"yyyyMMdd"),Oe=new Date(Date.parse("01/02/1990, "+$("#time_fromTODO").val()));le=(Oe.getHours()<10?"0"+Oe.getHours():Oe.getHours())+""+(Oe.getMinutes()<10?"0"+Oe.getMinutes():Oe.getMinutes())+"00";if(process_elem=process_elem.replace("##:::##AllDay##:::##",vcalendarEscapeValue("")),process_elem=process_elem.replace("##:::##TZID##:::##",f),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(fe+"T"+le+(E?"Z":""))),m){var De="";null!=vCalendar.tplM.VTcontentline_DUE.form&&null!=(De=vCalendar.tplM.VTcontentline_DUE.form[0])?""!=($e=("\r\n"+De).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(De=("\r\n"+De).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):De=(De=(De=vCalendar.tplC.VTcontentline_DUE).replace("##:::##group_wd##:::##","")).replace("##:::##params_wsc##:::##",""),s+=De=(De=(De=De.replace("##:::##AllDay##:::##",vcalendarEscapeValue(""))).replace("##:::##TZID##:::##",f)).replace("##:::##value##:::##",vcalendarEscapeValue(fe+"T"+le+(E?"Z":"")))}s+=process_elem}if(("due"==$("#todo_type").val()||"both"==$("#todo_type").val())&&""!=$("#date_toTODO").val()){null!=vCalendar.tplM.VTcontentline_DUE.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_DUE.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_DUE,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""));oe=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_toTODO").val()),ie=$.fullCalendar.formatDate(oe,"yyyyMMdd");var Ee=new Date(Date.parse("01/02/1990, "+$("#time_toTODO").val()));me=(Ee.getHours()<10?"0"+Ee.getHours():Ee.getHours())+""+(Ee.getMinutes()<10?"0"+Ee.getMinutes():Ee.getMinutes())+"00";if(process_elem=process_elem.replace("##:::##AllDay##:::##",vcalendarEscapeValue("")),process_elem=process_elem.replace("##:::##TZID##:::##",f),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(ie+"T"+me+(E?"Z":""))),globalSettings.appleremindersmode.value){De="";null!=vCalendar.tplM.VTcontentline_E_DTSTART.form&&null!=(De=vCalendar.tplM.VTcontentline_E_DTSTART.form[0])?""!=($e=("\r\n"+De).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(De=("\r\n"+De).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):De=(De=(De=vCalendar.tplC.VTcontentline_E_DTSTART).replace("##:::##group_wd##:::##","")).replace("##:::##params_wsc##:::##",""),s+=De=(De=(De=De.replace("##:::##AllDay##:::##",vcalendarEscapeValue(""))).replace("##:::##TZID##:::##",f)).replace("##:::##value##:::##",vcalendarEscapeValue(ie+"T"+me+(E?"Z":"")))}s+=process_elem}}if(""!=v&&""!=v.type){if(v.repeatStart)K=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_fromTODO").val()),j=new Date(Date.parse("01/02/1990, "+$("#time_fromTODO").val()));else if(v.repeatEnd)K=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_toTODO").val()),j=new Date(Date.parse("01/02/1990, "+$("#time_toTODO").val()));if(v.repeatStart)Q=v.repeatStart;else if(v.repeatEnd)var Ve=v.repeatEnd;K.setHours(j.getHours()),K.setMinutes(j.getMinutes()),K.setSeconds(j.getSeconds());var Me=new Date(K.getTime());q=0;v.repeatStart?q=Me-Q:v.repeatEnd&&(q=Me-Ve);var he=v.vcalendar.match(vCalendar.pre.contentline_UID);if(null!=he&&(he=he[0].match(vCalendar.pre.contentline_parse)[4]),0!=q){for(var Ae=s,Re=new Array,be=new Array;null!=Ae.match(vCalendar.pre.vtodo);){if("\r\n"==Ae.substring(Ae.indexOf("BEGIN:VTODO")-2,Ae.indexOf("BEGIN:VTODO"))){var Se=Ae.substring(Ae.indexOf("BEGIN:VTODO")-2,Ae.indexOf("END:VTODO")+"END:VTODO".length);Ae=Ae.replace(Se,"")}else{Se=Ae.substring(Ae.indexOf("BEGIN:VTODO"),Ae.indexOf("END:VTODO")+"END:VTODO".length);Ae=Ae.replace(Se,""),Se+="\r\n"}Re[Re.length]=Se,be[be.length]=Se}0==Re.length&&console.log("Error: '"+l+"': unable to parse vTodo");for(var Ie=0;Ie<Re.length;Ie++){var xe=Re[Ie].match(vCalendar.pre.contentline_UID);if(null==xe||xe[0].match(vCalendar.pre.contentline_parse)[4]==he){var we=Re[Ie].match(vCalendar.pre.contentline_RECURRENCE_ID);if(null!=we){var $e=we[0].match(vCalendar.pre.contentline_parse);if(process_elem=vCalendar.tplC.VTcontentline_REC_ID,process_elem=process_elem.replace("##:::##group_wd##:::##",$e[1]),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),re=$e[4].parseComnpactISO8601()){re=new Date(re.getTime()+q);Te=$.fullCalendar.formatDate(re,"yyyyMMdd'T'HHmmss");E&&(Te+="Z"),process_elem=process_elem.replace("##:::##AllDay##:::##",vcalendarEscapeValue("")),process_elem=process_elem.replace("##:::##TZID##:::##",f),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(Te)),Re[Ie]=Re[Ie].replace(we[0],"\r\n"+process_elem)}}s=s.replace(be[Ie],Re[Ie])}}}}if("none"!=$(".completedOnTr").css("display")&&(null!=vCalendar.tplM.VTcontentline_COMPLETED.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_COMPLETED.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_COMPLETED,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),""!=$(".completedOnTr .date").val()&&""!=$(".completedOnTr .time").val())){var Le=$.datepicker.parseDate(globalSettings.datepickerformat.value,$(".completedOnTr .date").val()),ye=new Date(Date.parse("01/02/1990, "+$("#completedOnTime").val())),Ne=$.fullCalendar.parseDate($.fullCalendar.formatDate(Le,"yyyy'-'MM'-'dd")+"T"+$.fullCalendar.formatDate(ye,"HH':'mm'-'ss"));if(globalSettings.timezonesupport.value&&(u=$("#timezoneTODO").val()),"none"==$(".timezone_rowTODO").css("display")&&(u="local"),"local"!=u){W=-1*(X=getOffsetByTZ(u,Ne)).getSecondsFromOffset();Ne=new Date(Ne.setSeconds(W))}Te=$.fullCalendar.formatDate(Ne,"yyyyMMdd'T'HHmmss")+"Z";process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(Te)),s+=process_elem}if(m&&(0==s.indexOf("\r\n")&&T.lastIndexOf("\r\n")==T.length-2?T+=s.substring(2,s.length):0==s.indexOf("\r\n")&&T.lastIndexOf("\r\n")!=T.length-2||0!=s.indexOf("\r\n")&&T.lastIndexOf("\r\n")==T.length-2?T+=s:T+="\r\n"+s),""==$("#recurrenceIDTODO").val())M="orig";else M=$("#recurrenceIDTODO").val();if(void 0!==vCalendar.tplM.VTunprocessedVTODO.form&&null!=vCalendar.tplM.VTunprocessedVTODO.form)for(vev in vCalendar.tplM.VTunprocessedVTODO.form)vev==M&&(s+=vCalendar.tplM.VTunprocessedVTODO.form[vev].replace(RegExp("^\r\n"),""));m&&(s=""),null!=vCalendar.tplM.VTendVTODO.form&&null!=(process_elem=vCalendar.tplM.VTendVTODO.form[0])?m?T+=vCalendar.tplM.VTendVTODO.form[0]:s+=vCalendar.tplM.VTendVTODO.form[0]:(process_elem=vCalendar.tplC.VTendVTODO,process_elem=process_elem.replace("##:::##group_wd##:::##",""),m?T+=process_elem:s+=process_elem),null!=vCalendar.tplM.VTcontentline_PRODID.form&&null!=(process_elem=vCalendar.tplM.VTcontentline_PRODID.form[0])?""!=($e=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")))[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+$e[1].replace(".","\\."),"mg"),"\r\nitem"+c+++".").substring(2)):(process_elem=vCalendar.tplC.VTcontentline_PRODID,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##value##:::##","-//Inf-IT//"+globalAppName+" "+globalVersion+"//EN"),s+=process_elem,void 0!==vCalendar.tplM.VTunprocessed.form&&""!=vCalendar.tplM.VTunprocessed.form&&null!=vCalendar.tplM.VTunprocessed.form&&(m?V+=vCalendar.tplM.VTunprocessed.form.replace(RegExp("^\r\n"),""):s+=vCalendar.tplM.VTunprocessed.form.replace(RegExp("^\r\n"),"")),vCalendar.tplM.VTunprocessed.form=new Array,null!=vCalendar.tplM.VTend.form&&null!=(process_elem=vCalendar.tplM.VTend.form[0])?s+=vCalendar.tplM.VTend.form[0]:(process_elem=vCalendar.tplC.VTend,process_elem=process_elem.replace("##:::##group_wd##:::##",""),s+=process_elem);var Ue=new Array;if(m)T+=s,V.lastIndexOf("\r\n")!=V.length-2&&(V+="\r\n"),V+=s,1==(Pe=checkAndFixMultipleUID(T,!1)).length?Ue[Ue.length]=V:Ue=Pe,s=T;else if(d.futureMode&&""!=g){var Pe;1==(Pe=checkAndFixMultipleUID(g,!1)).length?Ue[Ue.length]=g:Ue=Pe}var Ye=checkAndFixMultipleUID(s,!1);C=(Ye=$.merge(Ue,Ye))[0];return Ye.splice(0,1),"MOVE_IN"==e?moveVcalendarToCollection(a,l,n,C,r,"vtodo",!1,t,Ye):putVcalendarToCollection(a,l,n,C,r,"vtodo",!1,t,Ye)}function fullVcalendarToTodoData(e,a){var l="";if(a)var n="form";else n=e.repeatHash;CalDAVeditor_cleanup(n);var r=e.id.substring(0,e.id.lastIndexOf("/")+1);if(r&&null!=globalEventList.todos[r][e.id].uid&&(l=globalEventList.todos[r][e.id].vcalendar),!l)return!1;var t=l.split("\r\n");if(null==(parsed=("\r\n"+t[0]+"\r\n").match(vCalendar.pre.contentline_parse)))return!1;if(vCalendar.tplM.VTbegin[n]=new Array,vCalendar.tplM.VTbegin[n][0]=vCalendar.tplC.VTbegin.replace(/##:::##group_wd##:::##/g,vcalendar_begin_group=parsed[1]),null==(parsed=("\r\n"+t[t.length-2]+"\r\n").match(vCalendar.pre.contentline_parse)))return!1;if(vCalendar.tplM.VTend[n]=new Array,vCalendar.tplM.VTend[n][0]=vCalendar.tplC.VTend.replace(/##:::##group_wd##:::##/g,vcalendar_end_group=parsed[1]),vcalendar_begin_group!=vcalendar_end_group)return!1;for(var s=(l="\r\n"+t.slice(1,t.length-2).join("\r\n")+"\r\n").indexOf("BEGIN:VTIMEZONE"),c=l.indexOf("END:VTIMEZONE"),p=0,d="";-1!=s&&-1!=c;){for(V=c+2;V<l.length;V++)if("\n"==l.charAt(V)){p=V+1;break}d=l.substring(s,p),s=(l=l.substring(0,s)+l.substring(p,l.length)).indexOf("BEGIN:VTIMEZONE"),c=l.indexOf("END:VTIMEZONE")}if(vcalendar_element=l.match(vCalendar.pre.contentline_VERSION),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),version=vcalendarUnescapeValue(parsed[4]),vCalendar.tplM.VTcontentline_VERSION[n]=new Array,vCalendar.tplM.VTcontentline_VERSION[n][0]=vCalendar.tplC.VTcontentline_VERSION,vCalendar.tplM.VTcontentline_VERSION[n][0]=vCalendar.tplM.VTcontentline_VERSION[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_VERSION[n][0]=vCalendar.tplM.VTcontentline_VERSION[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),l=l.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(var o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=l.match(o));)vCalendar.tplM.VTcontentline_VERSION[n][0]+=vcalendar_element_related[0].substr(2),l=l.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=l.match(vCalendar.pre.contentline_CALSCALE),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),version=vcalendarUnescapeValue(parsed[4]),vCalendar.tplM.VTcontentline_CALSCALE[n]=new Array,vCalendar.tplM.VTcontentline_CALSCALE[n][0]=vCalendar.tplC.VTcontentline_CALSCALE,vCalendar.tplM.VTcontentline_CALSCALE[n][0]=vCalendar.tplM.VTcontentline_CALSCALE[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_CALSCALE[n][0]=vCalendar.tplM.VTcontentline_CALSCALE[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),l=l.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=l.match(o));)vCalendar.tplM.VTcontentline_CALSCALE[n][0]+=vcalendar_element_related[0].substr(2),l=l.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=l.match(RegExp("\r\n"+vCalendar.re.contentline_PRODID,"mi")),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_PRODID[n]=new Array,vCalendar.tplM.VTcontentline_PRODID[n][0]=vCalendar.tplC.VTcontentline_PRODID,vCalendar.tplM.VTcontentline_PRODID[n][0]=vCalendar.tplM.VTcontentline_PRODID[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_PRODID[n][0]=vCalendar.tplM.VTcontentline_PRODID[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),l=l.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=l.match(o));)vCalendar.tplM.VTcontentline_PRODID[n][0]+=vcalendar_element_related[0].substr(2),l=l.replace(vcalendar_element_related[0],"\r\n");for(var i=new Array;null!=l.match(vCalendar.pre.vtodo);){if("\r\n"==l.substring(l.indexOf("BEGIN:VTODO")-2,l.indexOf("BEGIN:VTODO"))){var _=l.substring(l.indexOf("BEGIN:VTODO")-2,l.indexOf("END:VTODO")+"END:VTODO".length);l=l.replace(_,"")}else{_=l.substring(l.indexOf("BEGIN:VTODO"),l.indexOf("END:VTODO")+"END:VTODO".length);l=l.replace(_,""),_+="\r\n"}i[i.length]=_}0==i.length&&console.log("Error: '"+e.id+"': unable to parse vTodo");for(var m=0;m<i.length;m++){var v=i[m],T=v.split("\r\n"),u=!1;if(null==v)return!1;if(null==(parsed="\r\nBEGIN:VTODO\r\n".match(vCalendar.pre.contentline_parse)))return!1;if(vCalendar.tplM.VTbeginVTODO[n]=new Array,vCalendar.tplM.VTbeginVTODO[n][0]=vCalendar.tplC.VTbeginVTODO.replace(/##:::##group_wd##:::##/g,vcalendar_begin_group=parsed[1]),null==(parsed=("\r\n"+t[T.length-2]+"\r\n").match(vCalendar.pre.contentline_parse)))return!1;if(vCalendar.tplM.VTendVTODO[n]=new Array,vCalendar.tplM.VTendVTODO[n][0]=vCalendar.tplC.VTendVTODO.replace(/##:::##group_wd##:::##/g,vcalendar_end_group=parsed[1]),vcalendar_begin_group!=vcalendar_end_group)return!1;v="\r\n"+T.slice(2,T.length-1).join("\r\n")+"\r\n";var g="",C="",f="",O="";if(vcalendar_element=v.match(vCalendar.pre.contentline_RECURRENCE_ID),null!=vcalendar_element){parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse);O=parsed[4];vCalendar.tplM.VTcontentline_REC_ID[n]=new Array,vCalendar.tplM.VTcontentline_REC_ID[n][0]=vCalendar.tplC.VTcontentline_REC_ID,vCalendar.tplM.VTcontentline_REC_ID[n][0]=vCalendar.tplM.VTcontentline_REC_ID[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]);for(var D=vcalendarSplitParam(parsed[3]),E="",V=0;V<D.length;V++)"VALUE=DATE"!=D[V]&&-1==D[V].indexOf("TZID=")&&""!=D[V]&&(E+=";"+D[V]);if(vCalendar.tplM.VTcontentline_REC_ID[n][0]=vCalendar.tplM.VTcontentline_REC_ID[n][0].replace(/##:::##params_wsc##:::##/g,E),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1])for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_REC_ID[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n")}if(""==O?O="orig":C=O,vcalendar_element=v.match(RegExp("\r\n"+vCalendar.re.contentline_CREATED,"mi")),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_CREATED[n]={},vCalendar.tplM.VTcontentline_CREATED[n][O]=vCalendar.tplC.VTcontentline_CREATED,vCalendar.tplM.VTcontentline_CREATED[n][O]=vCalendar.tplM.VTcontentline_CREATED[n][O].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_CREATED[n][O]=vCalendar.tplM.VTcontentline_CREATED[n][O].replace(/##:::##params_wsc##:::##/g,parsed[3]),g=parsed[4],vCalendar.tplM.VTcontentline_CREATED[n][O]=vCalendar.tplM.VTcontentline_CREATED[n][O].replace(/##:::##value##:::##/g,parsed[4]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_CREATED[n][O]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=v.match(vCalendar.pre.contentline_RRULE2),null!=vcalendar_element){parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_RRULE[n]=new Array,vCalendar.tplM.VTcontentline_RRULE[n][0]=vCalendar.tplC.VTcontentline_RRULE,vCalendar.tplM.VTcontentline_RRULE[n][0]=vCalendar.tplM.VTcontentline_RRULE[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]);for(D=parsed[4].split(";"),E="",V=0;V<D.length;V++)-1==D[V].indexOf("FREQ=")&&-1==D[V].indexOf("COUNT=")&&-1==D[V].indexOf("UNTIL=")&&""!=D[V]&&-1==D[V].indexOf("INTERVAL=")&&-1==D[V].indexOf("BYDAY=")&&-1==D[V].indexOf("BYMONTHDAY=")&&-1==D[V].indexOf("BYMONTH=")&&-1==D[V].indexOf("WKST=")&&(E+=";"+D[V]),-1!=D[V].indexOf("FREQ=")&&(f=D[V].split("FREQ=")[1]);if(vCalendar.tplM.VTcontentline_RRULE[n][0]=vCalendar.tplM.VTcontentline_RRULE[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),vCalendar.tplM.VTcontentline_RRULE[n][0]=vCalendar.tplM.VTcontentline_RRULE[n][0].replace(/##:::##value##:::##/g,"##:::##value##:::##"+E),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1])for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_RRULE[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n")}if((""!=f?e.id+"#"+g+"#"+f:e.id+"#"+g+"#"+C)==n&&(u=!0),vcalendar_element=v.match(vCalendar.pre.contentline_SUMMARY),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),title=vcalendarUnescapeValue(parsed[4]),vCalendar.tplM.VTcontentline_SUMMARY[n]=new Array,vCalendar.tplM.VTcontentline_SUMMARY[n][0]=vCalendar.tplC.VTcontentline_SUMMARY,vCalendar.tplM.VTcontentline_SUMMARY[n][0]=vCalendar.tplM.VTcontentline_SUMMARY[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_SUMMARY[n][0]=vCalendar.tplM.VTcontentline_SUMMARY[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_SUMMARY[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=v.match(RegExp("\r\n"+vCalendar.re.contentline_TRANSP,"mi")),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_TRANSP[n]=new Array,vCalendar.tplM.VTcontentline_TRANSP[n][0]=vCalendar.tplC.VTcontentline_TRANSP,vCalendar.tplM.VTcontentline_TRANSP[n][0]=vCalendar.tplM.VTcontentline_TRANSP[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_TRANSP[n][0]=vCalendar.tplM.VTcontentline_TRANSP[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_TRANSP[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=v.match(vCalendar.pre.contentline_STATUS),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),title=vcalendarUnescapeValue(parsed[4]),vCalendar.tplM.VTcontentline_STATUS[n]=new Array,vCalendar.tplM.VTcontentline_STATUS[n][0]=vCalendar.tplC.VTcontentline_STATUS,vCalendar.tplM.VTcontentline_STATUS[n][0]=vCalendar.tplM.VTcontentline_STATUS[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_STATUS[n][0]=vCalendar.tplM.VTcontentline_STATUS[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_STATUS[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=v.match(RegExp("\r\n"+vCalendar.re.contentline_LOCATION,"mi")),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),title=vcalendarUnescapeValue(parsed[4]),vCalendar.tplM.VTcontentline_LOCATION[n]=new Array,vCalendar.tplM.VTcontentline_LOCATION[n][0]=vCalendar.tplC.VTcontentline_LOCATION,vCalendar.tplM.VTcontentline_LOCATION[n][0]=vCalendar.tplM.VTcontentline_LOCATION[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_LOCATION[n][0]=vCalendar.tplM.VTcontentline_LOCATION[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_LOCATION[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=v.match(RegExp("\r\n"+vCalendar.re.contentline_URL,"mi")),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),title=vcalendarUnescapeValue(parsed[4]),vCalendar.tplM.VTcontentline_URL[n]=new Array,vCalendar.tplM.VTcontentline_URL[n][0]=vCalendar.tplC.VTcontentline_URL,vCalendar.tplM.VTcontentline_URL[n][0]=vCalendar.tplM.VTcontentline_URL[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_URL[n][0]=vCalendar.tplM.VTcontentline_URL[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_URL[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=v.match(vCalendar.pre["contentline_PERCENT-COMPLETE"]),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),title=vcalendarUnescapeValue(parsed[4]),vCalendar.tplM["VTcontentline_PERCENT-COMPLETE"][n]=new Array,vCalendar.tplM["VTcontentline_PERCENT-COMPLETE"][n][0]=vCalendar.tplC["VTcontentline_PERCENT-COMPLETE"],vCalendar.tplM["VTcontentline_PERCENT-COMPLETE"][n][0]=vCalendar.tplM["VTcontentline_PERCENT-COMPLETE"][n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM["VTcontentline_PERCENT-COMPLETE"][n][0]=vCalendar.tplM["VTcontentline_PERCENT-COMPLETE"][n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM["VTcontentline_PERCENT-COMPLETE"][n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=v.match(vCalendar.pre.contentline_PRIORITY),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),title=vcalendarUnescapeValue(parsed[4]),vCalendar.tplM.VTcontentline_PRIORITY[n]=new Array,vCalendar.tplM.VTcontentline_PRIORITY[n][0]=vCalendar.tplC.VTcontentline_PRIORITY,vCalendar.tplM.VTcontentline_PRIORITY[n][0]=vCalendar.tplM.VTcontentline_PRIORITY[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_PRIORITY[n][0]=vCalendar.tplM.VTcontentline_PRIORITY[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_PRIORITY[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");var M=v.match(vCalendar.pre.valarm);if(null!=M){v=v.replace(M[0],""),vCalendar.tplM.VTalarm_STRING[n]="";var h="",A=new Array;for(V=0;V<M[0].length;V++)"END:VALARM"==M[0].substring(V-"END:VALARM".length,V)&&(A[A.length]=h+"\r\n",u&&(vCalendar.tplM.VTalarm_STRING[n]+=h+"\r\n"),h=""),h+=M[0][V];for(var R=0;R<A.length;R++)if(checkA=A[R].match(vCalendar.re.valarm),null!=checkA){var b=checkA[0].split("\r\n");if(null==(parsed=("\r\n"+b[0]+"\r\n").match(vCalendar.pre.contentline_parse)))return!1;if(vCalendar.tplM.VTbeginVALARM[n]=new Array,vCalendar.tplM.VTbeginVALARM[n][R]=vCalendar.tplC.VTbeginVALARM.replace(/##:::##group_wd##:::##/g,vcalendar_begin_group=parsed[1]),null==(parsed=("\r\n"+b[b.length-2]+"\r\n").match(vCalendar.pre.contentline_parse)))return!1;if(vCalendar.tplM.VTendVALARM[n]=new Array,vCalendar.tplM.VTendVALARM[n][R]=vCalendar.tplC.VTendVALARM.replace(/##:::##group_wd##:::##/g,vcalendar_end_group=parsed[1]),vcalendar_begin_group!=vcalendar_end_group)return!1;if(A[R]="\r\n"+b.slice(1,b.length-2).join("\r\n")+"\r\n",trigger=A[R].match(vCalendar.pre.contentline_TRIGGER),null!=trigger){parsed=(trigger[0]+"\r\n").match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_TRIGGER[n]=new Array,vCalendar.tplM.VTcontentline_TRIGGER[n][R]=vCalendar.tplC.VTcontentline_TRIGGER,vCalendar.tplM.VTcontentline_TRIGGER[n][R]=vCalendar.tplM.VTcontentline_TRIGGER[n][R].replace(/##:::##group_wd##:::##/g,parsed[1]);for(D=vcalendarSplitParam(parsed[3]),E="",V=0;V<D.length;V++)"VALUE=DATE-TIME"!=D[V]&&"VALUE=DURATION"!=D[V]&&""!=D[V]&&(E+=";"+D[V]);if(vCalendar.tplM.VTcontentline_TRIGGER[n][R]=vCalendar.tplM.VTcontentline_TRIGGER[n][R].replace(/##:::##params_wsc##:::##/g,E),A[R]=A[R].replace(trigger[0],"\r\n"),""!=parsed[1])for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_TRIGGER[n][R]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n")}if(note=A[R].match(vCalendar.pre.contentline_NOTE),null!=note&&(parsed=note[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_VANOTE[n]=new Array,vCalendar.tplM.VTcontentline_VANOTE[n][R]=vCalendar.tplC.VTcontentline_VANOTE,vCalendar.tplM.VTcontentline_VANOTE[n][R]=vCalendar.tplM.VTcontentline_VANOTE[n][R].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_VANOTE[n][R]=vCalendar.tplM.VTcontentline_VANOTE[n][R].replace(/##:::##params_wsc##:::##/g,parsed[3]),A[R]=A[R].replace(note[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_VANOTE[n][R]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");if(action=A[R].match(vCalendar.pre.contentline_ACTION),null!=action&&(parsed=action[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_ACTION[n]=new Array,vCalendar.tplM.VTcontentline_ACTION[n][R]=vCalendar.tplC.VTcontentline_ACTION,vCalendar.tplM.VTcontentline_ACTION[n][R]=vCalendar.tplM.VTcontentline_ACTION[n][R].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_ACTION[n][R]=vCalendar.tplM.VTcontentline_ACTION[n][R].replace(/##:::##params_wsc##:::##/g,parsed[3]),A[R]=A[R].replace(action[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_ACTION[n][R]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");var S=$.trim(A[R]);vCalendar.tplM.VTunprocessedVALARM[n]=new Array,""!=S&&(vCalendar.tplM.VTunprocessedVALARM[n][R]=A[R])}}if(vcalendar_element=v.match(vCalendar.pre.contentline_NOTE),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_NOTE[n]=new Array,vCalendar.tplM.VTcontentline_NOTE[n][0]=vCalendar.tplC.VTcontentline_NOTE,vCalendar.tplM.VTcontentline_NOTE[n][0]=vCalendar.tplM.VTcontentline_NOTE[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_NOTE[n][0]=vCalendar.tplM.VTcontentline_NOTE[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_NOTE[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=v.match(vCalendar.pre.contentline_CLASS),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_CLASS[n]=new Array,vCalendar.tplM.VTcontentline_CLASS[n][0]=vCalendar.tplC.VTcontentline_CLASS,vCalendar.tplM.VTcontentline_CLASS[n][0]=vCalendar.tplM.VTcontentline_CLASS[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_CLASS[n][0]=vCalendar.tplM.VTcontentline_CLASS[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),vCalendar.tplM.VTcontentline_CLASS[n][0]=vCalendar.tplM.VTcontentline_CLASS[n][0].replace(/##:::##value##:::##/g,parsed[4]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_CLASS[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=v.match(vCalendar.pre.contentline_DUE),null!=vcalendar_element){parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_DUE[n]=new Array,vCalendar.tplM.VTcontentline_DUE[n][0]=vCalendar.tplC.VTcontentline_DUE,vCalendar.tplM.VTcontentline_DUE[n][0]=vCalendar.tplM.VTcontentline_DUE[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]);for(D=vcalendarSplitParam(parsed[3]),E="",V=0;V<D.length;V++)"VALUE=DATE"!=D[V]&&-1==D[V].indexOf("TZID=")&&""!=D[V]&&(E+=";"+D[V]);if(vCalendar.tplM.VTcontentline_DUE[n][0]=vCalendar.tplM.VTcontentline_DUE[n][0].replace(/##:::##params_wsc##:::##/g,E),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1])for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_DUE[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n")}if(vcalendar_element=v.match(vCalendar.pre.contentline_DTSTART),null!=vcalendar_element){parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_E_DTSTART[n]=new Array,vCalendar.tplM.VTcontentline_E_DTSTART[n][0]=vCalendar.tplC.VTcontentline_E_DTSTART,vCalendar.tplM.VTcontentline_E_DTSTART[n][0]=vCalendar.tplM.VTcontentline_E_DTSTART[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]);for(D=vcalendarSplitParam(parsed[3]),E="",V=0;V<D.length;V++)"VALUE=DATE"!=D[V]&&-1==D[V].indexOf("TZID=")&&""!=D[V]&&(E+=";"+D[V]);if(vCalendar.tplM.VTcontentline_E_DTSTART[n][0]=vCalendar.tplM.VTcontentline_E_DTSTART[n][0].replace(/##:::##params_wsc##:::##/g,E),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1])for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_E_DTSTART[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n")}if(vcalendar_element=v.match(RegExp("\r\n"+vCalendar.re.contentline_UID,"mi")),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_UID[n]=new Array,vCalendar.tplM.VTcontentline_UID[n][0]=vCalendar.tplC.VTcontentline_UID,vCalendar.tplM.VTcontentline_UID[n][0]=vCalendar.tplM.VTcontentline_UID[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_UID[n][0]=vCalendar.tplM.VTcontentline_UID[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),vCalendar.tplM.VTcontentline_UID[n][0]=vCalendar.tplM.VTcontentline_UID[n][0].replace(/##:::##uid##:::##/g,parsed[4]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_UID[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=v.match(RegExp("\r\n"+vCalendar.re.contentline_LM,"mi")),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_LM[n]=new Array,vCalendar.tplM.VTcontentline_LM[n][0]=vCalendar.tplC.VTcontentline_LM,vCalendar.tplM.VTcontentline_LM[n][0]=vCalendar.tplM.VTcontentline_LM[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_LM[n][0]=vCalendar.tplM.VTcontentline_LM[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_LM[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");if(vcalendar_element=v.match(RegExp("\r\n"+vCalendar.re.contentline_DTSTAMP,"mi")),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_DTSTAMP[n]=new Array,vCalendar.tplM.VTcontentline_DTSTAMP[n][0]=vCalendar.tplC.VTcontentline_DTSTAMP,vCalendar.tplM.VTcontentline_DTSTAMP[n][0]=vCalendar.tplM.VTcontentline_DTSTAMP[n][0].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_DTSTAMP[n][0]=vCalendar.tplM.VTcontentline_DTSTAMP[n][0].replace(/##:::##params_wsc##:::##/g,parsed[3]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_DTSTAMP[n][0]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");for(V=-1;null!=v.match(vCalendar.pre.contentline_EXDATE);)if(V++,vcalendar_element=v.match(vCalendar.pre.contentline_EXDATE),null!=vcalendar_element){parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_EXDATE[n]=new Array,vCalendar.tplM.VTcontentline_EXDATE[n][V]=vCalendar.tplC.VTcontentline_EXDATE,vCalendar.tplM.VTcontentline_EXDATE[n][V]=vCalendar.tplM.VTcontentline_EXDATE[n][V].replace(/##:::##group_wd##:::##/g,parsed[1]);D=vcalendarSplitParam(parsed[3]),E="";var I="";for(R=0;R<D.length;R++)"VALUE=DATE"!=D[R]&&""!=D[R]&&(E+=";"+D[R]),"VALUE=DATE"==D[R]&&(I=D[R]);if(-1!=I.indexOf("VALUE=DATE")?vCalendar.tplM.VTcontentline_EXDATE[n][V]=vCalendar.tplM.VTcontentline_EXDATE[n][V].replace(/##:::##AllDay##:::##/g,";VALUE=DATE"):vCalendar.tplM.VTcontentline_EXDATE[n][V]=vCalendar.tplM.VTcontentline_EXDATE[n][V].replace(/##:::##AllDay##:::##/g,""),vCalendar.tplM.VTcontentline_EXDATE[n][V]=vCalendar.tplM.VTcontentline_EXDATE[n][V].replace(/##:::##TZID##:::##/g,""),vCalendar.tplM.VTcontentline_EXDATE[n][V]=vCalendar.tplM.VTcontentline_EXDATE[n][V].replace(/##:::##params_wsc##:::##/g,E),vCalendar.tplM.VTcontentline_EXDATE[n][V]=vCalendar.tplM.VTcontentline_EXDATE[n][V].replace(/##:::##value##:::##/g,parsed[4]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1])for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_EXDATE[n][V]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n")}if(vcalendar_element=v.match(RegExp("\r\n"+vCalendar.re.contentline_COMPLETED,"mi")),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),vCalendar.tplM.VTcontentline_COMPLETED[n]={},vCalendar.tplM.VTcontentline_COMPLETED[n][O]=vCalendar.tplC.VTcontentline_COMPLETED,vCalendar.tplM.VTcontentline_COMPLETED[n][O]=vCalendar.tplM.VTcontentline_COMPLETED[n][O].replace(/##:::##group_wd##:::##/g,parsed[1]),vCalendar.tplM.VTcontentline_COMPLETED[n][O]=vCalendar.tplM.VTcontentline_COMPLETED[n][O].replace(/##:::##params_wsc##:::##/g,parsed[3]),v=v.replace(vcalendar_element[0],"\r\n"),""!=parsed[1]))for(o=RegExp("\r\n"+parsed[1].replace(".","\\..*")+"\r\n","im");null!=(vcalendar_element_related=v.match(o));)vCalendar.tplM.VTcontentline_COMPLETED[n][O]+=vcalendar_element_related[0].substr(2),v=v.replace(vcalendar_element_related[0],"\r\n");0==l.indexOf("\r\n")&&(l=l.substring(2,l.length-2)),l.lastIndexOf("\r\n")!=l.length-2&&(l+="\r\n"),vCalendar.tplM.VTunprocessedVTODO[n]={},vCalendar.tplM.VTunprocessedVTODO[n][O]=v,u=!1}0==l.indexOf("\r\n")&&(l=l.substring(2,l.length-2)),l.lastIndexOf("\r\n")!=l.length-2&&(l+="\r\n"),vCalendar.tplM.VTunprocessedVTIMEZONE[n]=d,vCalendar.tplM.VTunprocessed[n]=l}function vcalendarTodoData(e,a,l){var n=a.vcalendar,r=new Array,t=new Array;if(null==(check=a.vcalendar.match(vCalendar.pre.vtodo)))return console.log("Error: '"+a.uid+"': unable to parse vTodo"),!1;var s=n.match(vCalendar.pre.contentline_CALSCALE);if(null!=s&&"GREGORIAN"!=s[0].match(vCalendar.pre.contentline_parse)[4])return console.log("Error:'"+a.uid+"': Unsupported calscale in:"+n),!1;var c=n.match(vCalendar.pre.contentline_VERSION);if(null!=c){var p=c[0].match(vCalendar.pre.contentline_parse)[4];if("2.0"!=p)return console.log("Error:'"+a.uid+"': Unsupported version ("+p+") in:"+n),!1}for(var d=n.indexOf("BEGIN:VTIMEZONE"),o=n.indexOf("END:VTIMEZONE"),i=0;-1!=n.indexOf("BEGIN:VTIMEZONE");)if(-1!=d&&-1!=o){for(ce=o+2;ce<n.length;ce++)if("\n"==n.charAt(ce)){i=ce+1;break}vTimeZone=n.substring(d,i),n=n.substring(0,d)+n.substring(i,n.length)}for(var _=a.uid.substring(0,a.uid.lastIndexOf("/")+1),m=(a.uid.substring(a.uid.lastIndexOf("/")+1,a.uid.length),new Array);null!=n.match(vCalendar.pre.vtodo);){if("\r\n"==n.substring(n.indexOf("BEGIN:VTODO")-2,n.indexOf("BEGIN:VTODO"))){var v=n.substring(n.indexOf("BEGIN:VTODO")-2,n.indexOf("END:VTODO")+"END:VTODO".length);n=n.replace(v,"")}else{v=n.substring(n.indexOf("BEGIN:VTODO"),n.indexOf("END:VTODO")+"END:VTODO".length);n=n.replace(v,""),v+="\r\n"}var T=v.match(vCalendar.pre.contentline_RECURRENCE_ID),u=v.match(vCalendar.pre.contentline_UID);null!=u&&null!=T&&(m[m.length]=T[0].match(vCalendar.pre.contentline_parse)[4]+";"+u[0].match(vCalendar.pre.contentline_parse)[4]),r[r.length]=v}if(0==r.length)return!1;for(var g=!1,C=0;C<r.length;C++){var f="",O="",D="",E="",V=!1,M="",h="",A=!1,R=new Array,b=new Array,S=new Array,I="",x="local",w="",L="",y="",N=!1,U="",P="",Y="",Z="",H=(h="",""),k="",B=(A=!1,""),z="",G="",F="",X="",W=!0,K=new Array,Q=(_=a.uid.substring(0,a.uid.lastIndexOf("/")+1),""),j="",q=0,J="0",ee="0",ae=(new Array,a.vcalendar),le=(new Array,(ae=r[C]).match(vCalendar.pre.contentline_UID));null!=le&&(le=le[0].match(vCalendar.pre.contentline_parse)[4]);for(var ne=new Array,re=null,te=new Array,se=ae+"";null!=se.match(vCalendar.pre.contentline_EXDATE);)re=se.match(vCalendar.pre.contentline_EXDATE),te[te.length]=re[0],se=se.replace(re,"\r\n");if(vcalendar_element=ae.match(vCalendar.pre.contentline_RRULE2),null!=vcalendar_element){parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse);(K=parsed[4].split(";")).length>0&&(N=!0);for(var ce=0;ce<K.length;ce++)if(-1!=K[ce].indexOf("FREQ="))M=K[ce].split("=")[1];else if(-1!=K[ce].indexOf("INTERVAL="))Z=K[ce].split("=")[1];else if(-1!=K[ce].indexOf("COUNT=")){if(0==(h=K[ce].split("=")[1])){W=!1;break}if(isNaN(h)){W=!1;break}}else if(-1!=K[ce].indexOf("UNTIL="))A=!0,h=K[ce].split("=")[1];else if(-1!=K[ce].indexOf("WKST="))B=K[ce].split("=")[1].replace(/\d*MO/,1).replace(/\d*TU/,2).replace(/\d*WE/,3).replace(/\d*TH/,4).replace(/\d*FR/,5).replace(/\d*SA/,6).replace(/\d*SU/,0),null!=globalSettings.mozillasupport.value&&globalSettings.mozillasupport.value&&(B="");else if(-1!=K[ce].indexOf("BYMONTHDAY="))K[ce].split("=")[1];else if(-1!=K[ce].indexOf("BYDAY=")&&(z=(z=K[ce].split("=")[1]).replace(/\d*MO/,1).replace(/\d*TU/,2).replace(/\d*WE/,3).replace(/\d*TH/,4).replace(/\d*FR/,5).replace(/\d*SA/,6).replace(/\d*SU/,0).split(",")).length>1&&("MONTHLY"==M||"YEARLY"==M))return console.log("Error:'"+a.uid+"': Unsupported recurrence rule in todo:"+ae),!1;if(!W)return!1;Z||(Z=1)}var pe="";if(vcalendar_element=ae.match(vCalendar.pre.contentline_DTSTART),null!=vcalendar_element){parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),-1==(pe=O=parsed[4]).indexOf("T")?(pe=pe.substring(0,4)+"-"+pe.substring(4,6)+"-"+pe.substring(6,8),V=!0):(pe=pe.substring(0,4)+"-"+pe.substring(4,6)+"-"+pe.substring(6,8)+"T"+pe.substring(9,11)+":"+pe.substring(11,13)+":"+pe.substring(13,15),V=!1);var de=$.fullCalendar.parseDate(pe);if(O=pe,null==de)return!1;if("Invalid Date"==de.toString())return!1;if(null!=te)for(var oe=0;oe<te.length;oe++){if(-1!=(ge=(te[oe]+"\r\n").match(vCalendar.pre.contentline_parse)[4]).indexOf("T")&&-1!=ge.indexOf("Z"))var ie=ge.parseComnpactISO8601().setSeconds(-1*getLocalOffset(ge.parseComnpactISO8601()));else if(-1!=ge.indexOf("T")&&-1==ge.indexOf("Z"))ie=ge.parseComnpactISO8601();else{-1!=O.indexOf("T")&&(ge+="T"+$.fullCalendar.formatDate(de,"HHmmss"));ie=ge.parseComnpactISO8601()}ne[ne.length]=new Date(ie).toString()}var _e=parsed[3].split("=");if(!V){if("Z"==parsed[4].charAt(parsed[4].length-1)&&(x="UTC"),_e.length>1||"UTC"==x)"UTC"!=x&&(x=$.trim(_e[1])),null!=(Se=checkTimezone(x))&&(x=Se),globalSettings.timezonesupport.value&&x in timezones&&(I=getOffsetByTZ(x,de),U=-1*getLocalOffset(de)*1e3-1e3*I.getSecondsFromOffset());else-1==processedTimezones.indexOf(x)&&(-1==timeZonesEnabled.indexOf(x)&&timeZonesEnabled.push("local"),processedTimezones.push("local"));""!=x&&"local"!=x&&-1==processedTimezones.indexOf(x)&&(-1==timeZonesEnabled.indexOf(x)&&timeZonesEnabled.push(x),processedTimezones.push(x))}P=O,-1!=pe.indexOf("T")&&(""!=U&&de.setTime(de.getTime()+U),O=$.fullCalendar.formatDate(de,"u")),a.start=$.fullCalendar.parseDate(O)}if(vcalendar_element=ae.match(vCalendar.pre.contentline_DUE),null!=vcalendar_element){parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse);var me=D=parsed[4],ve="";if(-1==me.indexOf("T")){me=me.substring(0,4)+"-"+me.substring(4,6)+"-"+me.substring(6,8);var Te=$.fullCalendar.parseDate(me),ue=new Date(Te.getTime());-1==pe.indexOf("T")&&ue.setDate(ue.getDate()-1),V=!0,ve=me=$.fullCalendar.formatDate(ue,"yyyy-MM-dd"),-1!=pe.indexOf("T")&&(V=!1,me+="T00:00:00","UTC"==x&&(me+="Z"))}else ve=me=me.substring(0,4)+"-"+me.substring(4,6)+"-"+me.substring(6,8)+"T"+me.substring(9,11)+":"+me.substring(11,13)+":"+me.substring(13,15),V=!1;if(D=me,null==(Re=$.fullCalendar.parseDate(D)))return!1;if("Invalid Date"==Re.toString())return!1;if(null!=te&&0==ne.length)for(oe=0;oe<te.length;oe++){var ge;if(-1!=(ge=(te[oe]+"\r\n").match(vCalendar.pre.contentline_parse)[4]).indexOf("T")&&-1!=ge.indexOf("Z"))ie=ge.parseComnpactISO8601().setSeconds(-1*getLocalOffset(ge.parseComnpactISO8601()));else if(-1!=ge.indexOf("T")&&-1==ge.indexOf("Z"))ie=ge.parseComnpactISO8601();else{-1!=D.indexOf("T")&&(ge+="T"+$.fullCalendar.formatDate(Re,"HHmmss"));ie=ge.parseComnpactISO8601()}ne[ne.length]=new Date(ie).toString()}if(""==U&&(-1!=pe.indexOf("T")||-1!=ve.indexOf("T"))){_e=parsed[3].split("=");if("Z"==parsed[4].charAt(parsed[4].length-1)&&(x="UTC"),_e.length>1||"UTC"==x)"UTC"!=x&&-1!=ve.indexOf("T")&&(x=$.trim(_e[1])),null!=(Se=checkTimezone(x))&&(x=Se),globalSettings.timezonesupport.value&&x in timezones&&(I=getOffsetByTZ(x,Re),U=-1*getLocalOffset(Re)*1e3-1e3*I.getSecondsFromOffset())}Y=me,globalSettings.appleremindersmode.value&&(P=me),-1!=me.indexOf("T")&&(""!=U&&Re.setTime(Re.getTime()+U),D=$.fullCalendar.formatDate(Re,"u")),a.end=D,globalSettings.appleremindersmode.value&&(O=D)}globalSettings.appleremindersmode.value&&""==Y&&""!=P&&(P="",O="");var Ce="",fe=ae.match(vCalendar.pre.valarm);if(null!=fe){ae=ae.replace(fe[0],"");var Oe="",De=new Array;for(ce=0;ce<fe[0].length;ce++)"END:VALARM"==fe[0].substring(ce-"END:VALARM".length,ce)&&(De[De.length]=Oe+"\r\n",Oe=""),Oe+=fe[0][ce];for(oe=0;oe<De.length;oe++)if(0==De[oe].indexOf("\r\n")&&Ce.lastIndexOf("\r\n")==Ce.length-2?Ce+=De[oe].substring(2,De[oe].length):0==De[oe].indexOf("\r\n")&&Ce.lastIndexOf("\r\n")!=Ce.length-2||0!=De[oe].indexOf("\r\n")&&Ce.lastIndexOf("\r\n")==Ce.length-2?Ce+=De[oe]:Ce+="\r\n"+De[oe],checkA=De[oe].match(vCalendar.re.valarm),null!=checkA){if(action=De[oe].match(vCalendar.pre.contentline_ACTION),null==action)break;if(parsed=action[0].match(vCalendar.pre.contentline_parse),trigger=De[oe].match(vCalendar.pre.contentline_TRIGGER),null==trigger)break;if(parsed=(trigger[0]+"\r\n").match(vCalendar.pre.contentline_parse),null!=parsed){value=parsed[4];var Ee="",Ve="";if(null!=value.match(vCalendar.pre["date-time-value"])){if(parsed[3])var Me=parsed[3].split("=");var he=$.fullCalendar.parseDate(value.substring(0,4)+"-"+value.substring(4,6)+"-"+value.substring(6,8)+"T"+value.substring(9,11)+":"+value.substring(11,13)+":"+value.substring(13,15));if("Z"==value.charAt(value.length-1)&&(Ve="UTC"),Me.length>1||"UTC"==Ve){if("UTC"!=Ve&&";TZID"==Me[0]&&(Ve=$.trim(Me[1])),null!=(Se=checkTimezone(Ve))&&(Ve=Se),globalSettings.timezonesupport.value&&Ve in timezones){var Ae=getOffsetByTZ(Ve,he);Ee="local"!=x?1e3*getOffsetByTZ(x,he).getSecondsFromOffset()-1e3*Ae.getSecondsFromOffset():-1*getLocalOffset(he)*1e3-1e3*Ae.getSecondsFromOffset()}}else-1==processedTimezones.indexOf(x)&&(-1==timeZonesEnabled.indexOf(x)&&timeZonesEnabled.push("local"),processedTimezones.push("local"));""!=Ve&&"local"!=x&&-1==processedTimezones.indexOf(Ve)&&(-1==timeZonesEnabled.indexOf(Ve)&&timeZonesEnabled.push(Ve),processedTimezones.push(Ve)),""!=Ee&&he.setTime(he.getTime()+Ee),R[oe]=$.fullCalendar.formatDate(he,"yyyy-MM-dd'T'HH:mm:ss")}else R[oe]=0,-1!=value.indexOf("W")?R[oe]=parseAlarmWeek(value):-1!=value.indexOf("D")?R[oe]=parseAlarmDay(value):-1!=value.indexOf("T")&&(R[oe]=parseAlarmTime(value)),"-"==parsed[4].charAt(0)?R[oe]="-"+R[oe]:R[oe]="+"+R[oe]}alnote=De[oe].match(vCalendar.pre.contentline_NOTE),null!=alnote?(parsed=alnote[0].match(vCalendar.pre.contentline_parse),b[oe]=parsed[4]):b[oe]="Default note"}}if(vcalendar_element=ae.match(vCalendar.pre.contentline_LOCATION),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),k=vcalendarUnescapeValue(parsed[4])),vcalendar_element=ae.match(vCalendar.pre.contentline_NOTE),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),f=vcalendarUnescapeValue(parsed[4])),vcalendar_element=ae.match(vCalendar.pre.contentline_CLASS),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),w=vcalendarUnescapeValue(parsed[4])),vcalendar_element=ae.match(vCalendar.pre.contentline_URL),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),L=vcalendarUnescapeValue(parsed[4])),vcalendar_element=ae.match(vCalendar.pre.contentline_RECURRENCE_ID),null!=vcalendar_element)parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),G=parsed[4];switch(vcalendar_element=ae.match(vCalendar.pre.contentline_SUMMARY),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),E=vcalendarUnescapeValue(parsed[4])),vcalendar_element=ae.match(vCalendar.pre.contentline_CREATED),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),F=vcalendarUnescapeValue(parsed[4])),vcalendar_element=ae.match(vCalendar.pre.contentline_STATUS),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),Q=vcalendarUnescapeValue(parsed[4])),!globalSettings.appleremindersmode.value||"IN-PROCESS"!=Q&&"CANCELLED"!=Q||(Q="NEEDS-ACTION"),Q){case"NEEDS-ACTION":j="filterAction";break;case"COMPLETED":j="filterCompleted";break;case"IN-PROCESS":j="filterProgress";break;case"CANCELLED":j="filterCanceled";break;default:j="filterAction"}if(vcalendar_element=ae.match(vCalendar.pre.contentline_COMPLETED),null!=vcalendar_element){parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse);var Re,be=parsed[4];if(-1!=be.indexOf("T")&&(be=be.substring(0,4)+"-"+be.substring(4,6)+"-"+be.substring(6,8)+"T"+be.substring(9,11)+":"+be.substring(11,13)+":"+be.substring(13,15)),""!=(H=null==(Re=$.fullCalendar.parseDate(be))||"Invalid Date"==Re.toString()?"":new Date(Re.getTime()))){var Se;Ee="",Me=new Array;if(parsed[3]&&(Me=parsed[3].split("=")),"Z"==parsed[4].charAt(parsed[4].length-1)&&(Ve="UTC"),Me.length>1||"UTC"==Ve){if("UTC"!=Ve&&(Ve=$.trim(Me[1])),null!=(Se=checkTimezone(Ve))&&(Ve=Se),globalSettings.timezonesupport.value&&Ve in timezones){Ae=getOffsetByTZ(Ve,H);Ee=1e3*getOffsetByTZ(x,H).getSecondsFromOffset()-1e3*Ae.getSecondsFromOffset()}}else-1==processedTimezones.indexOf(x)&&(-1==timeZonesEnabled.indexOf(x)&&timeZonesEnabled.push("local"),processedTimezones.push("local"));""!=x&&"local"!=x&&-1==processedTimezones.indexOf(Ve)&&(-1==timeZonesEnabled.indexOf(Ve)&&timeZonesEnabled.push(Ve),processedTimezones.push(Ve)),""!=Ee&&H.setTime(H.getTime()+Ee)}}if("COMPLETED"==Q&&""==H&&""!=D&&"object"==typeof D&&(H=new Date(D.getTime())),vcalendar_element=ae.match(vCalendar.pre["contentline_PERCENT-COMPLETE"]),null!=vcalendar_element&&(parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),J=vcalendarUnescapeValue(parsed[4])),vcalendar_element=ae.match(vCalendar.pre.contentline_PRIORITY),null!=vcalendar_element){parsed=vcalendar_element[0].match(vCalendar.pre.contentline_parse),ee=vcalendarUnescapeValue(parsed[4]);var Ie=parseInt(ee,10);isNaN(Ie)||(q=ee>5&&ee<10?3:ee<5&&ee>0?1:5==ee?2:0)}a.uid.substring(a.uid.lastIndexOf("/")+1,a.uid.length);var xe=0,we=!1;if(N&&(P||Y)?X=a.uid+"#"+F+"#"+M:N||(X=a.uid+"#"+F+"#"+G),""!=J&&"0"!=J&&"100"!=J&&"50"!=J&&(void 0===globalTodolistStatusArray[X]&&(globalTodolistStatusArray[X]={}),globalTodolistStatusArray[X].percent=J),!l&&!g){var $e=findEventInArray(a.uid,!1,null!=globalCalTodo?globalCalTodo.repeatHash:null);if(""!=$e&&($e.etag!=a.etag||$("#showTODO").val()==a.uid&&("true"==$("#repeatTodo").val()||""!=$("#recurrenceIDTODO").val())&&!g)){for(var Le=0;Le<$e.alertTimeOut.length;Le++)clearTimeout($e.alertTimeOut[Le]);if($("#showTODO").val()==a.uid)if("true"==$("#repeatTodo").val()||""!=$("#recurrenceIDTODO").val())if("undefined"==typeof globalCalTodo||null==globalCalTodo||globalCalTodo.repeatHash!=X){var ye=globalCalTodo.title;$("#editAllTODO").css("visibility","hidden"),$("#editFutureTODO").css("visibility","hidden"),$("#editOnlyOneTODO").css("visibility","hidden"),$("#repeatConfirmBoxContentTODO").html("<b>"+ye+"</b> "+localization[globalInterfaceLanguage].repeatChangeTxt),$("#repeatConfirmBoxQuestionTODO").html(localization[globalInterfaceLanguage].repeatTodoChangeTxtClose)}else we=!0,g=!0,$("#todoList").fullCalendar("selectEvent");else we=!0}}var Ne=0;for(xe=0;xe<globalResourceCalDAVList.TodoCollections.length;xe++)if(void 0!==globalResourceCalDAVList.TodoCollections[xe].uid&&globalResourceCalDAVList.TodoCollections[xe].uid==e.uid){Ne=xe;break}var Ue=new RegExp("^(https?://)([^@/]+(?:@[^@/]+)?)@([^/]+)(.*/)([^/]+/)([^/]+/)([^/]*)","i"),Pe=(_.match(Ue),(Ne.pad(String(globalResourceCalDAVList.TodoCollections.length).length)+E).toLowerCase());if(N&&(P||Y)){null!=globalAppleSupport.nextDates[a.uid]&&delete globalAppleSupport.nextDates[a.uid];var Ye=ae.match(vCalendar.pre.contentline_RRULE2)[0].match(vCalendar.pre.contentline_parse)[4];if(a.isRepeat=!0,P)var Ze=new Date($.fullCalendar.parseDate(P).getTime());else if(Y)Ze=new Date($.fullCalendar.parseDate(Y).getTime());if(Y)var He=new Date($.fullCalendar.parseDate(Y).getTime());var ke="",Be="";P&&(ke=new Date(Ze.getTime())),Y&&(Be=new Date(He.getTime()));var ze="",Ge="",Fe="";if(""!==h){if(A){if(-1!=h.indexOf("T")){var Xe=h.substring(0,4)+"-"+h.substring(4,6)+"-"+h.substring(6,8)+"T"+h.substring(9,11)+":"+h.substring(11,13)+":"+h.substring(13,15),We=$.fullCalendar.parseDate(Xe);if(null==We)return!1;if("Invalid Date"==We.toString())return!1;if(globalSettings.timezonesupport.value&&x in timezones&&(I=getOffsetByTZ(x,We)),I){U=1e3*I.getSecondsFromOffset();We.setTime(We.getTime()+U)}ze=new Date(We.getTime())}else ze=$.fullCalendar.parseDate(h.substring(0,4)+"-"+h.substring(4,6)+"-"+h.substring(6,8)),""!=P?(ze.setHours($.fullCalendar.parseDate(P).getHours()),ze.setMinutes($.fullCalendar.parseDate(P).getMinutes()),ze.setSeconds($.fullCalendar.parseDate(P).getSeconds())):""!=Y&&(ze.setHours($.fullCalendar.parseDate(Y).getHours()),ze.setMinutes($.fullCalendar.parseDate(Y).getMinutes()),ze.setSeconds($.fullCalendar.parseDate(Y).getSeconds()));Fe=""}else ze="",Fe=h;Ge=ze,a.untilDate=ze}else ze=globalToLoadedLimitTodo,Ge="",a.untilDate="never";var Ke=new Date(globalToLoadedLimitTodo.getTime());Ke.setMonth(Ke.getMonth()+2);var Qe=0;Y&&(Qe=He.getTime()-Ze.getTime());generateTodoRepeatInstances({dayDifference:Qe,untilDate:Ge,repeatStart:ke,repeatEnd:Be,futureRLimit:Ke,stringUID:le,recurrence_id_array:m,exDates:ne,alertTime:R,ignoreAlarms:e.ignoreAlarms,isChange:we,todoArray:r,preTodoArray:t,realRepeatCount:0,repeatCount:0,items:new todoItems(O,D,Ge,M,Z,Fe,B,ke,Be,0,0,z,k,f,E,a.uid,ae,a.etag,R,b,Q,j,G,X,J,a.displayValue,_,Pe,x,P,Y,S,w,L,H,C,ee,q,Ce,Ye)})}else{if(""!=D&&"string"==typeof D){var je=$.fullCalendar.parseDate(D);D=new Date(je.getTime())}e.ignoreAlarms||(S=setAlertTimeouts(!0,R,O,D,{title:E,status:Q},!0,a.uid));y=new todoItems(O,D,"","","","","","","","","","",k,f,E,a.uid,ae,a.etag,R,b,Q,j,G,X,J,a.displayValue,_,Pe,x,P,Y,S,w,L,H,C,ee,q,Ce,"");t.splice(t.length,0,y),we&&(globalCalTodo=y)}deleteEventFromArray(a.uid),$.merge(globalEventList.displayTodosArray[_],t)}}